<!DOCTYPE html>
<html>
<head>
  <title>Dashboard | Apna Punjab SMP</title>
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=Orbitron&display=swap" rel="stylesheet">
</head>
<body>

<!-- Full screen flashy welcome -->
<div class="full-screen-message">
  <img src="welcome-bg.png" alt="Background Image" class="welcome-img">
  <h2>à¨«à©œà©à¨¹à¨²à©‹ ğŸ–•ğŸ»</h2>
</div>

<!-- Main dashboard panel -->
<div class="dashboard">
  <h1>Welcome Team ğŸš€</h1>
  <p class="subtitle">Apna Punjab SMP â€“ Staff Panel</p>

  <!-- Staff role cards -->
  <div class="staff-cards">
    <div class="card owner">Owner: stevejatt</div>
    <div class="card one-owner">Owner: Gurisidhu</div>
    <div class="card devloper">server dev: Exogurir</div>
    <div class="card one-devloper">web dev: Tanvir</div>
    <div class="card admin">admin: Manuxpaji</div>
  </div>
  
  <!-- server stats -->
  <div class="server-status">
  <h2>ğŸŸ¢ Live Server Status</h2>

  <div class="server-card">
    <h3>Lobby</h3>
    <p id="lobby-status">Checking...</p>
    <p id="lobby-players"></p>
    <ul id="lobby-list"></ul>
  </div>

  <div class="server-card">
    <h3>Survival</h3>
    <p id="survival-status">Checking...</p>
    <p id="survival-players"></p>
    <ul id="survival-list"></ul>
  </div>

  <div class="server-card">
    <h3>Bedwars</h3>
    <p id="bedwars-status">Checking...</p>
    <p id="bedwars-players"></p>
    <ul id="bedwars-list"></ul>
  </div>

  <div class="server-card">
    <h3>Lifesteel</h3>
    <p id="lifesteel-status">Checking...</p>
    <p id="lifesteel-players"></p>
    <ul id="lifesteel-list"></ul>
  </div>

  </div>

  <!-- Interactive buttons -->
  <div class="dashboard-buttons">
    <button onclick="copyIP()">Copy Server IP</button>
    <a href="https://discord.gg/PjkNUFE8HW" target="_blank">
      <button>Discord</button>
    </a>
    <a href="donate.html" target="_blank">
      <button>Donate</button>
    </a>
  </div>

  <!-- Logout -->
  <button class="logout-btn" onclick="logout()">Logout</button>
</div>
  
<iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vRXRCgoE12E5Ou9nnWvKF2w5-SlIeDxVtVQ2I5d3aoP-sG6WRGDCT2biQ6VBh1aZqv01grB71YemeNO/pubhtml?widget=true&amp;headers=false" style="width:100%; height:500px; border:none; overflow:auto;"></iframe>

<!-- Firebase + server scripts -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>

<script>
  // Firebase config
  const firebaseConfig = {
    apiKey: "AIzaSyCebfHkVB98q9jDGhtqNvtz0lfAzApGouM",
    authDomain: "team-login-c3730.firebaseapp.com",
    projectId: "team-login-c3730",
  };

  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();

  // Protect dashboard
  auth.onAuthStateChanged(user => {
    if (!user) {
      window.location.href = "team-login.html";
    }
  });

  // Logout
  function logout() {
    auth.signOut().then(() => {
      window.location.href = "team-login.html";
    });
  }

  // Copy server IP
  function copyIP() {
    navigator.clipboard.writeText("apnapunjab.fun");
    alert("Server IP Copied!");
  }

  // Flashy welcome fade out
setTimeout(() => {
  document.querySelector('.full-screen-message').style.display = 'none';
}, 3000);

  // Live Minecraft server status
  // ===== Servers Array =====
const servers = [
  {name:"Lobby", ip:"apnapunjab.fun:25566", statusId:"lobby-status", playersId:"lobby-players", listId:"lobby-list"},
  {name:"Survival", ip:"apnapunjab.fun:25569", statusId:"survival-status", playersId:"survival-players", listId:"survival-list"},
  {name:"Bedwars", ip:"apnapunjab.fun:25567", statusId:"bedwars-status", playersId:"bedwars-players", listId:"bedwars-list"},
  {name:"Lifesteel", ip:"apnapunjab.fun:25568", statusId:"lifesteel-status", playersId:"lifesteel-players", listId:"lifesteel-list"}
];

function fetchServer(server) {
  fetch(`https://api.mcsrvstat.us/2/${server.ip}`)
    .then(res => res.json())
    .then(data => {
      const statusEl = document.getElementById(server.statusId);
      const playersEl = document.getElementById(server.playersId);
      const listEl = document.getElementById(server.listId);

      if(data.online){
        statusEl.innerHTML = "ğŸŸ¢ ONLINE";
        playersEl.innerHTML = `ğŸ‘¥ ${data.players.online} / ${data.players.max} players`;

        listEl.innerHTML = "";
        if(data.players.list && data.players.list.length > 0){
          data.players.list.forEach(name=>{
            const li = document.createElement("li");
            li.innerText = name;
            listEl.appendChild(li);
          });
        } else {
          listEl.innerHTML = "<li>No players online</li>";
        }

      } else {
        statusEl.innerHTML = "ğŸ”´ OFFLINE";
        playersEl.innerHTML = "";
        listEl.innerHTML = "";
      }
    })
    .catch(()=>{
      const statusEl = document.getElementById(server.statusId);
      const playersEl = document.getElementById(server.playersId);
      const listEl = document.getElementById(server.listId);
      statusEl.innerText = "âš ï¸ Status unavailable";
      playersEl.innerText = "";
      listEl.innerHTML = "";
    });
}

// Load all servers
servers.forEach(s => fetchServer(s));

// Auto refresh every 15 sec
setInterval(()=>servers.forEach(s=>fetchServer(s)),15000);
  
</script>
  
<script src="script.js"></script>
</body>
</html>
